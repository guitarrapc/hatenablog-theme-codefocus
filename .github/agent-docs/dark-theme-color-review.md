---
title: dark theme color spec base review
date: 2026-02-12
effective: actives since v1.11.0
---

# ダークテーマ背景色・コードブロック背景色の見直し検討

本ドキュメントは、現在のダークテーマの背景色（`--background`）およびコードブロック背景色（`--bg-code`）を見直すための検討資料です。`dark-theme-accessibility-spec.md` のWCAGガイドラインを踏まえ、複数の改善案を比較・検討します。

---

## 1. 現状分析

### 1.1 現在のダークテーマ配色

| トークン | SCSS変数 | 色コード | 用途 |
|----------|----------|----------|------|
| `--background` | `$dark-background` → `$color-dark-gray-100` | `#0d1117` | ページ全体の背景 |
| `--bg-light` | `$dark-bg-light` → `$color-dark-gray-300` | `#1a1d21` | 定義のみ（未使用） |
| `--bg-code` | `$dark-bg-code` → `$color-dark-gray-200` | `#161b22` | コードブロック背景 |
| `--bg-code-light` | `$dark-bg-code-light` → `$color-dark-gray-400` | `#1e232a` | コードブロックボタン背景 |
| `--bg-semi-transparent` | `$dark-background-semi-transparent` | `rgba(13,17,23,0.95)` | 背景画像対応 |
| `--text-body` | `$dark-text-body` → `$color-dark-gray-1200` | `#ffffff` | 本文テキスト |
| `--text-header` | `$dark-text-header` → `$color-dark-gray-1100` | `#e6edf3` | 見出しテキスト |

**設計の出自**: 現在の配色は **GitHub Dark Default** テーマをベースにしている（`#0d1117`はGitHubのデフォルトダーク背景そのもの）。

### 1.2 現状の問題点

#### 問題1: 背景色が暗すぎる（純黒に近い）

```
#0d1117 の相対輝度: 0.005483
これは #000000 (輝度 0) に非常に近い「ほぼ黒」
```

`dark-theme-accessibility-spec.md` §3.1 では **「背景は純黒(#000)にしない。#121212のような"ほぼ黒"にして、白文字との強烈な対比を避ける」** と記載。

現在の `#0d1117` は `#121212` よりさらに暗く、純黒に近い。

#### 問題2: テキストとのコントラストが過剰

| 組み合わせ | コントラスト比 | 評価 |
|-----------|---------------|------|
| `#0d1117` vs `#ffffff`（本文） | **18.92:1** | WCAG AA (4.5:1) を大幅超過 |
| `#0d1117` vs `#e6edf3`（見出し） | **16.02:1** | 同上 |

コントラスト比が高すぎると、以下の問題が生じる:
- **ハレーション**: 暗い背景に明るい文字が「にじんで」見える現象。乱視のユーザーで特に顕著
- **目の疲労**: 長時間の読書で眼精疲労が増加
- **Material Design推奨範囲**: 本文テキストは概ね **7:1〜15:1** が読みやすい

参考: GitHub Dark Default の本文テキストは `#e6edf3`（記事見出しと同じ）であり、純白は使用していない。

#### 問題3: コードブロックと背景の区別がつかない

```
背景 #0d1117 (L=0.005483) vs コードBG #161b22 (L=0.010699)
コントラスト比: 1.094:1  ΔL = 0.00522
```

これは **視覚的にほぼ区別不可能** なレベル。比較として:
- GitHub Dark Dimmed のサーフェス差: **1.179:1**（ΔL=0.01253）
- 人間が暗い色同士の差を知覚するには、最低でも ΔL=0.01 以上が望ましい

**特にCodeFocusテーマでは致命的**: テーマ名が「CodeFocus」であり、コードブロックは最も重要な視覚要素。ライトモードではコードブロックが暗い背景（`#1a2638`）で強く目立つが、ダークモードではほぼ溶け込んでしまう。

#### 問題4: コードブロックのボーダーが不可視

```scss
// _codeblock.scss
border: 1px solid var(--bg-code);  // ← ボーダーと背景が同色
```

コードブロックのボーダー色がコードブロックの背景色と同じため、ボーダーが見えない。背景色差だけでコードブロックの境界を表現しようとしているが、その背景色差自体が不足している。

### 1.3 ライトモードとの対比

| 要素 | ライトモード | ダークモード |
|------|-------------|-------------|
| 背景 vs コードBG | `#ffffff` vs `#1a2638` → **15.24:1** | `#0d1117` vs `#161b22` → **1.094:1** |
| コードブロックの視認性 | **極めて高い**（白地に濃紺） | **極めて低い**（暗い背景に暗い面） |

ライトモードではコードブロックがIDE風の暗い背景で明確に区別されるのに対し、ダークモードでは「背景より少し明るいだけ」の面で表現しており、視認性に大きな差がある。

---

## 2. 参考テーマの比較分析

### 2.1 主要ダークテーマの背景色

| テーマ | 背景 | コードBG/サーフェス | サーフェス差 | テキスト | テキストCR |
|--------|------|-------------------|-------------|----------|-----------|
| **現在のCodeFocus** | `#0d1117` | `#161b22` | **1.094:1** | `#ffffff` | 18.92:1 |
| GitHub Dark Default | `#0d1117` | `#161b22` | 1.094:1 | `#e6edf3` | 16.02:1 |
| **GitHub Dark Dimmed** | `#22272e` | `#2d333b` | **1.179:1** | `#adbac7` | 7.60:1 |
| VS Code Dark+ | `#1e1e1e` | `#252526` | 1.089:1 | `#d4d4d4` | 11.25:1 |
| VS Code Dark Modern | `#1f1f1f` | — | — | `#cccccc` | 10.26:1 |
| JetBrains Darcula | `#2b2b2b` | `#313335` | 1.116:1 | `#a9b7c6` | 6.93:1 |
| Atom One Dark | `#282c34` | `#21252b` | 1.100:1 | `#abb2bf` | 7.33:1 |
| Material Design推奨 | `#121212` | `#1E1E1E` | 1.124:1 | — | — |
| Spec推奨 | `#121212` | `#1E1E1E` | 1.124:1 | `#E6E6E6` | 15.01:1 |

### 2.2 分析の示唆

1. **背景の明るさ**: 多くの人気テーマは `#1e1e1e`〜`#2b2b2b` の範囲（現在の `#0d1117` より大幅に明るい）
2. **テキストコントラスト**: 快適な読書のためには **7:1〜12:1** が多い（現在の 18.92:1 は突出して高い）
3. **サーフェス階層**: GitHub Dark Dimmed（1.179:1）が最も視認性が高い
4. **色のニュアンス**: GitHub系はブルーティント、VS Code/Material は無彩色が特徴

---

## 3. 改善案

以下、3つの案を提示する。いずれもテーマの青みがかったアイデンティティを維持しつつ、問題点を改善する方向。

### 3.1 案A: マイルド調整（背景をやや明るく + コードBGの差を強化）

**コンセプト**: 現在の雰囲気を壊さず、実用上の問題だけを解消する最小限の変更。

| トークン | 現在 | 提案 | 変更理由 |
|----------|------|------|----------|
| `--background` | `#0d1117` | **`#141a22`** | 純黒感を緩和（+7段階明るく） |
| `--bg-code` | `#161b22` | **`#212b38`** | 背景との差を拡大 |
| `--bg-code-light` | `#1e232a` | **`#2a3444`** | コードボタンもそれに合わせて調整 |
| `--bg-light` | `#1a1d21` | **`#1e2530`** | 必要に応じ調整 |

**コントラスト検証**:

| 組み合わせ | 比率 | 判定 |
|-----------|------|------|
| bg `#141a22` vs text `#e6edf3` | 14.80:1 | AA OK ✅（適度に緩和） |
| bg `#141a22` vs text `#ffffff` | 17.49:1 | AA OK ✅ |
| bg `#141a22` vs text-low `#8b949e` | 5.69:1 | AA OK ✅ |
| bg `#141a22` vs code-bg `#212b38` | **1.222:1** | サーフェス差: 良好 ✅ |
| code-bg `#212b38` vs text `#e6edf3` | 12.11:1 | AA OK ✅ |

**利点**:
- 変更幅が小さく、既存デザインとの違和感が少ない
- ブルーティントを維持
- コードブロックの視認性を改善（1.094 → 1.222）

**懸念**:
- テキストコントラストはまだ高め（14.80:1）。読み疲れの根本解決には不十分かもしれない
- コードブロックの差はGitHub Dark Dimmedより良いが、劇的な改善ではない

---

### 3.2 案B: バランス調整（Dimmed寄りに + テキスト色も含めた総合調整） <- 採用

**コンセプト**: GitHub Dark Dimmed の快適さを取り入れつつ、独自のブルーティントを維持する中間的アプローチ。

| トークン | 現在 | 提案 | 変更理由 |
|----------|------|------|----------|
| `--background` | `#0d1117` | **`#1a1f27`** | Dimmed方向に寄せ、読み疲れを軽減 |
| `--bg-code` | `#161b22` | **`#272f3b`** | 明確なサーフェス差を確保 |
| `--bg-code-light` | `#1e232a` | **`#303a48`** | ボタン背景を調整 |
| `--bg-light` | `#1a1d21` | **`#232a34`** | 階層表現を強化 |
| `--text-body` | `#ffffff` | **`#e6edf3`** | 過剰コントラストの緩和（ハレーション軽減） |

**コントラスト検証**:

| 組み合わせ | 比率 | 判定 |
|-----------|------|------|
| bg `#1a1f27` vs text `#e6edf3` | 14.00:1 | AA OK ✅（採用） |
| bg `#1a1f27` vs text `#ffffff` | 16.55:1 | AA OK（参考: 従来値） |
| bg `#1a1f27` vs text-low `#8b949e` | 5.38:1 | AA OK ✅ |
| bg `#1a1f27` vs code-bg `#272f3b` | **1.226:1** | サーフェス差: 良好 ✅ |
| code-bg `#272f3b` vs text `#e6edf3` | 11.42:1 | AA OK ✅ |

**利点**:
- 最もバランスが取れたアプローチ
- コードブロックの視認性が大幅に改善（サーフェスコントラスト 1.094:1 → 1.226:1）
- 長時間読書の快適さがGitHub Dark Dimmedに近づく
- テキストコントラストが14:1に収まり、読みやすさと視認性のバランスが良い
- ハレーション軽減により目の疲労が軽減（16.55:1 → 14.00:1）

**実装状況（2026年2月採用）**:
- すべての推奨変更を実装済み
- カラースキーマ変数 `$color-dark-dimmed-100/200/300/400` として定義
- WCAG AA基準を満たしつつ、読みやすさとコードの視認性を最適化

---

### 3.3 案C: 背景維持・コードブロック強調（現在の背景を維持 + コードBGのみ大きく変更）

**コンセプト**: ページ背景は現状維持し、コードブロックだけを強く浮き上がらせる。CodeFocusのアイデンティティとして「暗い背景に浮かぶコード」を表現。

| トークン | 現在 | 提案 | 変更理由 |
|----------|------|------|----------|
| `--background` | `#0d1117` | **`#0d1117`**（変更なし） | 現在のデザインを維持 |
| `--bg-code` | `#161b22` | **`#1e2a3a`** | 大きな輝度差で明確に分離 |
| `--bg-code-light` | `#1e232a` | **`#283448`** | ボタン背景を調整 |
| `--bg-light` | `#1a1d21` | **`#1a1d21`**（変更なし） | 維持 |

**コントラスト検証**:

| 組み合わせ | 比率 | 判定 |
|-----------|------|------|
| bg `#0d1117` vs text `#ffffff` | 18.92:1 | AA OK ✅（高すぎる問題は維持） |
| bg `#0d1117` vs text `#e6edf3` | 16.02:1 | AA OK ✅ |
| bg `#0d1117` vs code-bg `#1e2a3a` | **1.304:1** | サーフェス差: 最大 ✅ |
| code-bg `#1e2a3a` vs text `#e6edf3` | 12.28:1 | AA OK ✅ |

**利点**:
- 背景色の変更なしのため既存デザインへの影響が最小
- コードブロックの浮き上がり効果が3案中最大（1.304:1）
- 「暗闇に浮かぶコード」という独自の視覚効果が得られる

**懸念**:
- 本文テキストの過剰コントラスト問題（18.92:1）が未解決
- 背景の「純黒に近い」問題（ハレーション）が残る
- コードブロック内テキストのコントラスト（12.28:1）と背景テキスト（18.92:1）の差が大きい

---

## 4. 比較サマリー

| 評価軸 | 案A（マイルド） | 案B（バランス） | 案C（コードBGのみ） |
|--------|----------------|----------------|-------------------|
| 変更の大きさ | 小 | 中 | 最小 |
| 背景の純黒問題 | △ 緩和 | ○ 改善 | ✕ 未解決 |
| テキストの過剰コントラスト | △ やや緩和 | ○ 改善 | ✕ 未解決 |
| コードブロック視認性 | ○ 1.222:1 | ○ 1.226:1 | ◎ 1.304:1 |
| 読み疲れの軽減 | △ 部分的 | ◎ 効果大 | ✕ 変化なし |
| デザインの一貫性 | ○ 自然 | △ 雰囲気の変化あり | ○ 自然 |
| ブルーティントの維持 | ○ | ○ | ○ |

---

## 5. 追加検討事項

### 5.1 テキスト色の見直し（全案共通の推奨事項）

背景色の変更とは独立して、本文テキスト色の見直しを推奨する。

| テキスト色 | bg `#0d1117` | bg `#141a22` | bg `#1a1f27` | 参考 |
|-----------|-------------|-------------|-------------|------|
| `#ffffff`（現在） | 18.92:1 | 17.49:1 | 14.00:1 | 過剰 |
| `#e6edf3`（GitHub推奨） | 16.02:1 | 14.80:1 | 14.00:1 | やや高い |
| `#d4d4d4`（VS Code風） | 12.77:1 | 11.80:1 | 10.14:1 | バランス良 |
| `#c9d1d9` | 12.26:1 | 11.33:1 | 9.73:1 | 快適 |
| `#adbac7`（GitHub Dimmed風） | 9.58:1 | 8.85:1 | 7.60:1 | 最も快適 |

**推奨**: WCAG AAを余裕で満たしつつ読みやすい **`#e6edf3`**（10〜15:1の範囲）を提案。現在のtext-header色と統一でき、GitHub Dark Defaultの標準テキスト色でもある。

> NOTE: テキスト色の変更は本検討の主題ではないが、背景色の変更と密接に関連するため参考として記載。

### 5.2 コードブロックのボーダー

現在のコードブロックのボーダーは背景色と同色（不可視）。背景色差を改善しても、ボーダーを視認可能にすることでコードブロックの境界をさらに明確にできる。

```scss
// 現在
border: 1px solid var(--bg-code);            // 不可視

// 改善案
border: 1px solid var(--border-light);        // 薄い境界線で区切り
// または
border: 1px solid rgba(255, 255, 255, 0.08);  // 微かな白い線
```

### 5.3 半透明背景の連動

`--bg-semi-transparent` は背景画像が設定されている場合の半透明オーバーレイ。背景色を変更する場合、この値も連動して変更する必要がある。

```scss
// 例: 案Aの場合
$dark-background-semi-transparent: rgba(20, 26, 34, 0.95); // #141a22ベース
```

### 5.4 サーフェス階層の全体像

背景色の変更は他のサーフェス色にも影響する。変更時には以下の階層全体を一貫性を持って調整する必要がある。

```
ページ背景 → bg-light → bg-code → bg-code-light → bg-btn-hover
    最暗        ↑          ↑          ↑              最明
            微かに明るい   さらに明るい   さらに明るい
```

---

## 6. 決定に向けた確認事項

1. **背景色をどの程度変更するか**: 案A（微調整）/ 案B（バランス）/ 案C（現状維持）
2. **テキスト色を同時に変更するか**: `#ffffff` → `#e6edf3` またはそれ以外
3. **コードブロックのボーダー**: 背景色差の改善だけで十分か、ボーダーも追加するか
4. **ライトモードのコードブロック背景との整合**: ダークモードでもコードブロックを「強く区別」するか、「微妙な差」に留めるか

---

## 7. 参考リンク

- [WCAG 2.2 SC 1.4.3 Contrast (Minimum)](https://www.w3.org/WAI/WCAG22/Understanding/contrast-minimum.html)
- [Material Design 3 Dark Theme](https://m3.material.io/styles/color/system/how-the-system-works)
- [GitHub Primer Color Usage](https://primer.style/foundations/color/overview)
- [dark-theme-accessibility-spec.md](dark-theme-accessibility-spec.md) — 本プロジェクトのアクセシビリティ仕様
- [_variable.scss](../../scss/lib/_variable.scss) — 現在の色定義
